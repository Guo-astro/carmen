language: cpp

compiler:
- gcc
- clang

env:
  matrix:
  - NODE_NVM_VERSION="0.10"
  - NODE_NVM_VERSION="0.8"

before_install:
# here we set up the node version on the fly based on the matrix value.
# This is done manually so that it is easy to flip the 'language' to
# objective-c in another branch (to run the same travis.yml on OS X)
- git clone https://github.com/creationix/nvm.git $HOME/.nvm
- source $HOME/.nvm/nvm.sh
- nvm install $NODE_NVM_VERSION
- nvm use $NODE_NVM_VERSION
- node --version
- npm --version
# carmen build dependencies
- sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test
- sudo add-apt-repository --yes ppa:chris-lea/protobuf
- sudo apt-get update
- sudo apt-get install gcc-4.8 g++-4.8 libprotobuf7 libprotobuf-dev protobuf-compiler
- npm install mocha
- ./scripts/install-dbs.sh

install:
- CXX=g++-4.8 npm install

script:
- time npm test
- make clean

